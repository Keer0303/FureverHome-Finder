{"ast":null,"code":"export default {\n  name: 'Home',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      notices: [],\n      animalData: [],\n      dialogVisible: false,\n      adoptionFormVisible: false,\n      noticeDialogVisible: false,\n      selectedAnimal: {},\n      adoptionForm: {\n        reason: ''\n      },\n      formLabelWidth: '120px'\n    };\n  },\n  created() {\n    this.$request.get('/notice/selectAll').then(res => {\n      this.notices = res.data || [];\n    });\n    this.loadAnimal();\n  },\n  methods: {\n    loadAnimal() {\n      this.$request.get('/animal/selectAll').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    openAdoptionForm(animal) {\n      this.selectedAnimal = animal;\n      this.adoptionFormVisible = true;\n    },\n    submitAdoptionForm() {\n      if (!this.adoptionForm.reason) {\n        this.$message.error('Please fill in the reason for adoption');\n        return;\n      }\n      let adoptData = {\n        userId: this.user.id,\n        animalId: this.selectedAnimal.id,\n        reason: this.adoptionForm.reason\n      };\n      this.$request.post('/adoptionApplication/addApplication', adoptData).then(res => {\n        if (res.data) {\n          this.$message.success('Adoption request sent');\n          this.adoptionFormVisible = false;\n          this.resetAdoptionForm();\n          this.loadAnimal(); // Reload animal data to reflect the status change\n        } else {\n          this.$message.error('Failed to send adoption request');\n        }\n      }).catch(error => {\n        console.error('Error sending adoption request:', error.response || error.message || error);\n        this.$message.error('An error occurred while sending adoption request');\n      });\n    },\n    resetAdoptionForm() {\n      this.adoptionForm = {\n        reason: ''\n      };\n    },\n    showDetails(animal) {\n      this.selectedAnimal = animal;\n      this.dialogVisible = true;\n    },\n    handleClose(done) {\n      this.dialogVisible = false;\n      done();\n    },\n    truncateDescr(descr) {\n      return descr.length > 30 ? descr.substring(0, 30) + '...' : descr;\n    },\n    showNotices() {\n      this.noticeDialogVisible = true;\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","localStorage","getItem","notices","animalData","dialogVisible","adoptionFormVisible","noticeDialogVisible","selectedAnimal","adoptionForm","reason","formLabelWidth","created","$request","get","then","res","loadAnimal","methods","code","$message","error","msg","openAdoptionForm","animal","submitAdoptionForm","adoptData","userId","id","animalId","post","success","resetAdoptionForm","catch","console","response","message","showDetails","handleClose","done","truncateDescr","descr","length","substring","showNotices"],"sources":["src/views/manager/Home.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"card header-card\">\n      Hello, {{ user?.name }},  Welcome to Furever Home Finder!\n      <el-button type=\"primary\" @click=\"showNotices\" class=\"notice-button\">Notice</el-button>\n    </div>\n\n    <div class=\"content\">\n      <div class=\"card pet-info-card\">\n        <!-- Pet Info -->\n        <div class=\"pet-info-title\">Adopt love, one paw at a time.</div>\n        <el-row>\n          <el-col :span=\"6\" v-for=\"item in animalData\" :key=\"item.id\">\n            <div class=\"card pet-card\">\n              <img :src=\"item.img\" alt=\"\" class=\"pet-image\">\n              <div class=\"pet-name\">{{ item.name }} <br>（{{ item.species }}）</div>\n              <div class=\"pet-details\">Sex：{{ item.sex }}， Age：{{ item.age }}</div>\n              <div class=\"pet-status\">Status：<span class=\"status-text\">{{ item.status }}</span></div>\n              <div class=\"about-me\">About me：<br><span class=\"about-me-text\">{{ item.descr }}</span></div>\n              <div>\n                <el-button type=\"success\" size=\"mini\" class=\"adopt-button\" :disabled=\"item.status === 'Adopted' || item.status === 'In Process'\" @click=\"openAdoptionForm(item)\">Adopt/Contact Admin to Adopt</el-button>\n                <el-button type=\"primary\" size=\"mini\" class=\"details-button\" @click=\"showDetails(item)\">View Details</el-button>\n              </div>\n            </div>\n          </el-col>\n        </el-row>\n      </div>\n    </div>\n\n    <!-- 申请领养表单对话框 -->\n    <el-dialog :visible.sync=\"adoptionFormVisible\" width=\"40%\" title=\"Adoption Application\">\n      <el-form :model=\"adoptionForm\" ref=\"adoptionForm\">\n        <el-form-item label=\"Reason\" :label-width=\"formLabelWidth\">\n          <el-input type=\"textarea\" v-model=\"adoptionForm.reason\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"adoptionFormVisible = false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"submitAdoptionForm\">Submit</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 详情对话框 -->\n    <el-dialog :visible.sync=\"dialogVisible\" width=\"30%\" :before-close=\"handleClose\">\n      <span slot=\"title\">{{ selectedAnimal.name }}'s Details</span>\n      <div>\n        <img :src=\"selectedAnimal.img\" alt=\"\" class=\"details-image\">\n        <div class=\"details-name\">{{ selectedAnimal.name }}</div>\n        <div class=\"details-info\">Species: {{ selectedAnimal.species }}</div>\n        <div class=\"details-info\">Sex: {{ selectedAnimal.sex }}</div>\n        <div class=\"details-info\">Age: {{ selectedAnimal.age }}</div>\n        <div class=\"details-info\">Status: <span :style=\"{ color: selectedAnimal.status === 'Adopted' ? '#7d3d0c' : '#000' }\">{{ selectedAnimal.status }}</span></div>\n        <div class=\"details-about\">About me: {{ selectedAnimal.descr }}</div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">Close</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 公告对话框 -->\n    <el-dialog :visible.sync=\"noticeDialogVisible\" width=\"50%\" title=\"Notice\">\n      <el-timeline reverse>\n        <el-timeline-item v-for=\"item in notices\" :key=\"item.id\" :timestamp=\"item.time\">\n          <el-popover\n              placement=\"right\"\n              width=\"200\"\n              trigger=\"hover\"\n              :content=\"item.content\">\n            <span slot=\"reference\">{{ item.title }}</span>\n          </el-popover>\n        </el-timeline-item>\n      </el-timeline>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"noticeDialogVisible = false\">Close</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Home',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      notices: [],\n      animalData: [],\n      dialogVisible: false,\n      adoptionFormVisible: false,\n      noticeDialogVisible: false,\n      selectedAnimal: {},\n      adoptionForm: {\n        reason: ''\n      },\n      formLabelWidth: '120px'\n    }\n  },\n  created() {\n    this.$request.get('/notice/selectAll').then(res => {\n      this.notices = res.data || []\n    })\n    this.loadAnimal()\n  },\n  methods: {\n\n    loadAnimal() {\n      this.$request.get('/animal/selectAll').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n\n    openAdoptionForm(animal) {\n      this.selectedAnimal = animal;\n      this.adoptionFormVisible = true;\n    },\n\n    submitAdoptionForm() {\n      if (!this.adoptionForm.reason) {\n        this.$message.error('Please fill in the reason for adoption');\n        return;\n      }\n\n      let adoptData = {\n        userId: this.user.id,\n        animalId: this.selectedAnimal.id,\n        reason: this.adoptionForm.reason\n      };\n\n      this.$request.post('/adoptionApplication/addApplication', adoptData).then(res => {\n        if (res.data) {\n          this.$message.success('Adoption request sent');\n          this.adoptionFormVisible = false;\n          this.resetAdoptionForm();\n          this.loadAnimal(); // Reload animal data to reflect the status change\n        } else {\n          this.$message.error('Failed to send adoption request');\n        }\n      }).catch(error => {\n        console.error('Error sending adoption request:', error.response || error.message || error);\n        this.$message.error('An error occurred while sending adoption request');\n      });\n    },\n\n    resetAdoptionForm() {\n      this.adoptionForm = {\n        reason: ''\n      };\n    },\n\n    showDetails(animal) {\n      this.selectedAnimal = animal;\n      this.dialogVisible = true;\n    },\n\n    handleClose(done) {\n      this.dialogVisible = false;\n      done();\n    },\n\n    truncateDescr(descr) {\n      return descr.length > 30 ? descr.substring(0, 30) + '...' : descr;\n    },\n\n    showNotices() {\n      this.noticeDialogVisible = true;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.el-col-6 {\n  padding: 10px;\n}\n.container {\n  display: flex;\n  flex-direction: row;\n}\n\n.header-card {\n  padding: 15px;\n  font-size: 24px;\n  font-weight: bold;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.notice-button {\n  margin-left: auto;\n}\n\n.content {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n}\n\n.pet-info-card {\n  width: 100%;\n  padding: 15px;\n}\n\n.pet-info-title {\n  margin-bottom: 20px;\n  font-size: 20px;\n  font-weight: bold;\n  color: #1F618D;\n}\n\n.pet-card {\n  background-color: #f8f4e8;\n  text-align: center;\n}\n\n.pet-image {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.pet-name {\n  font-weight: bold;\n  color: #817a70;\n  margin-top: 5px;\n}\n\n.pet-details, .pet-status {\n  color: #575353;\n  font-size: 13px;\n  margin-top: 5px;\n}\n\n.pet-status {\n  color: #7d3d0c;\n}\n\n.status-text {\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n}\n\n.about-me {\n  margin-top: 15px;\n  color: #4b4949;\n  text-align: left;\n}\n\n.about-me-text {\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n}\n\n.adopt-button, .details-button {\n  margin-top: 20px;\n}\n\n.details-image {\n  width: 300px;\n  height: 300px;\n  display: block;\n  margin: 0 auto;\n  object-fit: contain;\n}\n\n.details-name {\n  text-align: center;\n  margin-top: 10px;\n  font-weight: bold;\n  font-size: 18px;\n}\n\n.details-info, .details-about {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"AAgFA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,OAAA;MACAC,UAAA;MACAC,aAAA;MACAC,mBAAA;MACAC,mBAAA;MACAC,cAAA;MACAC,YAAA;QACAC,MAAA;MACA;MACAC,cAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,QAAA,CAAAC,GAAA,sBAAAC,IAAA,CAAAC,GAAA;MACA,KAAAb,OAAA,GAAAa,GAAA,CAAAnB,IAAA;IACA;IACA,KAAAoB,UAAA;EACA;EACAC,OAAA;IAEAD,WAAA;MACA,KAAAJ,QAAA,CAAAC,GAAA,sBAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAG,IAAA;UACA,KAAAf,UAAA,GAAAY,GAAA,CAAAnB,IAAA;QACA;UACA,KAAAuB,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAM,GAAA;QACA;MACA;IACA;IAEAC,iBAAAC,MAAA;MACA,KAAAhB,cAAA,GAAAgB,MAAA;MACA,KAAAlB,mBAAA;IACA;IAEAmB,mBAAA;MACA,UAAAhB,YAAA,CAAAC,MAAA;QACA,KAAAU,QAAA,CAAAC,KAAA;QACA;MACA;MAEA,IAAAK,SAAA;QACAC,MAAA,OAAA7B,IAAA,CAAA8B,EAAA;QACAC,QAAA,OAAArB,cAAA,CAAAoB,EAAA;QACAlB,MAAA,OAAAD,YAAA,CAAAC;MACA;MAEA,KAAAG,QAAA,CAAAiB,IAAA,wCAAAJ,SAAA,EAAAX,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAnB,IAAA;UACA,KAAAuB,QAAA,CAAAW,OAAA;UACA,KAAAzB,mBAAA;UACA,KAAA0B,iBAAA;UACA,KAAAf,UAAA;QACA;UACA,KAAAG,QAAA,CAAAC,KAAA;QACA;MACA,GAAAY,KAAA,CAAAZ,KAAA;QACAa,OAAA,CAAAb,KAAA,oCAAAA,KAAA,CAAAc,QAAA,IAAAd,KAAA,CAAAe,OAAA,IAAAf,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IAEAW,kBAAA;MACA,KAAAvB,YAAA;QACAC,MAAA;MACA;IACA;IAEA2B,YAAAb,MAAA;MACA,KAAAhB,cAAA,GAAAgB,MAAA;MACA,KAAAnB,aAAA;IACA;IAEAiC,YAAAC,IAAA;MACA,KAAAlC,aAAA;MACAkC,IAAA;IACA;IAEAC,cAAAC,KAAA;MACA,OAAAA,KAAA,CAAAC,MAAA,QAAAD,KAAA,CAAAE,SAAA,kBAAAF,KAAA;IACA;IAEAG,YAAA;MACA,KAAArC,mBAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}