{"ast":null,"code":"export default {\n  name: \"Adopt\",\n  data() {\n    return {\n      tableData: [],\n      // All data\n      pageNum: 1,\n      // Current page number\n      pageSize: 10,\n      // Number of items per page\n      total: 0,\n      animalId: null,\n      status: null,\n      // 初始化 status 变量\n      form: {},\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      ids: [],\n      animalData: []\n    };\n  },\n  created() {\n    this.load(1);\n    this.loadAnimal();\n  },\n  methods: {\n    loadAnimal() {\n      this.$request.get('/adopt/selectAnimal').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n          console.log(this.animalData); // 打印 animalData 以确认数据正确加载\n        } else {\n          this.$message.error(res.msg);\n        }\n      }).catch(error => {\n        console.error('Request failed', error);\n        this.$message.error('Failed to load animal data.');\n      });\n    },\n    handleAdd() {\n      // Add data\n      this.form = {}; // Clear data when adding new data\n      this.fromVisible = true; // Open the modal\n    },\n\n    handleEdit(row) {\n      // Edit data\n      this.form = JSON.parse(JSON.stringify(row)); // Deep copy data to form object\n      this.fromVisible = true; // Open the modal\n    },\n\n    save() {\n      // Logic triggered by save button, triggers add or update\n      this.$request({\n        url: this.form.id ? '/adopt/update' : '/adopt/add',\n        method: this.form.id ? 'PUT' : 'POST',\n        data: this.form\n      }).then(res => {\n        if (res.code === '200') {\n          // Indicates successful save\n          this.$message.success('Saved successfully');\n          this.load(1);\n          this.fromVisible = false;\n        } else {\n          this.$message.error(res.msg); // Show error message\n        }\n      });\n    },\n\n    GiveUp(row) {\n      this.$confirm('Are you sure you want to give up the adoption? Giving up the adoption means you will no longer be the potential adopter for this animal. If you have any concerns or need assistance, please contact our support team.', 'Confirm', {\n        type: \"warning\"\n      }).then(response => {\n        this.form = JSON.parse(JSON.stringify(row));\n        this.form.status = 'GiveUp Adoption';\n        this.save();\n      }).catch(() => {});\n    },\n    handleSelectionChange(rows) {\n      // Currently selected rows\n      this.ids = rows.map(v => v.id); //  [1,2]\n    },\n\n    delBatch() {\n      // Delete selected items\n      if (!this.ids.length) {\n        this.$message.warning('Please select data');\n        return;\n      }\n      this.$confirm('Are you sure you want to delete these data?', 'Confirm Delete', {\n        type: \"warning\"\n      }).then(response => {\n        this.$request.delete('/adopt/delete/batch', {\n          data: this.ids\n        }).then(res => {\n          if (res.code === '200') {\n            // Indicates successful operation\n            this.$message.success('Operation successful');\n            this.load(1);\n          } else {\n            this.$message.error(res.msg); // Show error message\n          }\n        });\n      }).catch(() => {});\n    },\n    load(pageNum) {\n      // Pagination query\n      if (pageNum) this.pageNum = pageNum;\n      this.$request.get('/adopt/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          status: this.status,\n          // 确保 status 变量被正确传递\n          animalId: this.animalId\n        }\n      }).then(res => {\n        this.tableData = res.data?.list;\n        this.total = res.data?.total;\n        console.log(this.tableData);\n      });\n    },\n    reset() {\n      this.status = null; // Reset status variable\n      this.load(1);\n      this.animalId = null;\n      this.loadAnimal();\n    },\n    created() {\n      this.loadAnimal(); // 在组件创建时加载数据\n    },\n\n    handleCurrentChange(pageNum) {\n      this.load(pageNum);\n    }\n  }\n};","map":{"version":3,"names":["name","data","tableData","pageNum","pageSize","total","animalId","status","form","user","JSON","parse","localStorage","getItem","ids","animalData","created","load","loadAnimal","methods","$request","get","then","res","code","console","log","$message","error","msg","catch","handleAdd","fromVisible","handleEdit","row","stringify","save","url","id","method","success","GiveUp","$confirm","type","response","handleSelectionChange","rows","map","v","delBatch","length","warning","delete","params","list","reset","handleCurrentChange"],"sources":["src/views/manager/Adopt.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"search\">\r\n      <el-select v-model=\"animalId\" placeholder=\"Search By Name\" style=\"width: 200px\"v-if=\"user.role === 'ADMIN'\">\r\n        <el-option v-for=\"item in animalData\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n      </el-select>\r\n      <el-select v-model=\"status\" placeholder=\"Search By Status\" style=\"width: 200px; margin-left: 5px\">\r\n        <el-option label=\"Adopted\" value=\"Adopted\"></el-option>\r\n        <el-option label=\"GiveUp Adoption\" value=\"GiveUp Adoption\"></el-option>\r\n      </el-select>\r\n      <el-button type=\"info\" plain style=\"margin-left: 10px\" @click=\"load(1)\">Search</el-button>\r\n      <el-button type=\"warning\" plain style=\"margin-left: 10px\" @click=\"reset\">Reset</el-button>\r\n    </div>\r\n\r\n    <div class=\"table\">\r\n      <el-table :data=\"tableData\" stripe @selection-change=\"handleSelectionChange\">\r\n        <el-table-column type=\"selection\" width=\"55\" align=\"center\"></el-table-column>\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\" align=\"center\" sortable></el-table-column>\r\n        <el-table-column prop=\"animalImg\" label=\"Pets Image\" show-overflow-tooltip>\r\n          <template v-slot=\"scope\">\r\n            <div style=\"display: flex; align-items: center\">\r\n              <el-image style=\"width: 40px; height: 40px; border-radius: 50%\" v-if=\"scope.row.animalImg\"\r\n                        :src=\"scope.row.animalImg\" :preview-src-list=\"[scope.row.animalImg]\"></el-image>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"animalName\" label=\"Pets Name\" show-overflow-tooltip></el-table-column>\r\n        <el-table-column prop=\"userName\" label=\"Adopter\" show-overflow-tooltip></el-table-column>\r\n        <el-table-column prop=\"time\" label=\"Adopt Time\"></el-table-column>\r\n        <el-table-column prop=\"status\" label=\"Adoption Status\"></el-table-column>\r\n        <el-table-column label=\"Actions\" width=\"180\" align=\"center\">\r\n          <template v-slot=\"scope\">\r\n            <el-button plain type=\"danger\" size=\"mini\" :disabled=\"scope.row.status === 'GiveUp Adoption'\" @click=\"GiveUp(scope.row)\">Give Up Adoption</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n            background\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"pageNum\"\r\n            :page-sizes=\"[5, 10, 20]\"\r\n            :page-size=\"pageSize\"\r\n            layout=\"total, prev, pager, next\"\r\n            :total=\"total\">\r\n        </el-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Adopt\",\r\n  data() {\r\n    return {\r\n      tableData: [],  // All data\r\n      pageNum: 1,   // Current page number\r\n      pageSize: 10,  // Number of items per page\r\n      total: 0,\r\n      animalId: null,\r\n      status: null,  // 初始化 status 变量\r\n      form: {},\r\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\r\n      ids: [],\r\n      animalData:[]\r\n    }\r\n  },\r\n  created() {\r\n    this.load(1)\r\n    this.loadAnimal();\r\n  },\r\n  methods: {\r\n    loadAnimal() {\r\n      this.$request.get('/adopt/selectAnimal').then(res => {\r\n        if (res.code === '200') {\r\n          this.animalData = res.data;\r\n          console.log(this.animalData); // 打印 animalData 以确认数据正确加载\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      }).catch(error => {\r\n        console.error('Request failed', error);\r\n        this.$message.error('Failed to load animal data.');\r\n      });\r\n    },\r\n\r\n    handleAdd() {   // Add data\r\n      this.form = {}  // Clear data when adding new data\r\n      this.fromVisible = true   // Open the modal\r\n    },\r\n    handleEdit(row) {   // Edit data\r\n      this.form = JSON.parse(JSON.stringify(row))  // Deep copy data to form object\r\n      this.fromVisible = true   // Open the modal\r\n    },\r\n    save() {   // Logic triggered by save button, triggers add or update\r\n      this.$request({\r\n        url: this.form.id ? '/adopt/update' : '/adopt/add',\r\n        method: this.form.id ? 'PUT' : 'POST',\r\n        data: this.form\r\n      }).then(res => {\r\n        if (res.code === '200') {  // Indicates successful save\r\n          this.$message.success('Saved successfully')\r\n          this.load(1)\r\n          this.fromVisible = false\r\n        } else {\r\n          this.$message.error(res.msg)  // Show error message\r\n        }\r\n      })\r\n    },\r\n    GiveUp(row) {\r\n      this.$confirm('Are you sure you want to give up the adoption? Giving up the adoption means you will no longer be the potential adopter for this animal. If you have any concerns or need assistance, please contact our support team.', 'Confirm', {type: \"warning\"}).then(response => {\r\n        this.form = JSON.parse(JSON.stringify(row));\r\n        this.form.status = 'GiveUp Adoption';\r\n        this.save();\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    handleSelectionChange(rows) {   // Currently selected rows\r\n      this.ids = rows.map(v => v.id)   //  [1,2]\r\n    },\r\n    delBatch() {   // Delete selected items\r\n      if (!this.ids.length) {\r\n        this.$message.warning('Please select data')\r\n        return\r\n      }\r\n      this.$confirm('Are you sure you want to delete these data?', 'Confirm Delete', {type: \"warning\"}).then(response => {\r\n        this.$request.delete('/adopt/delete/batch', {data: this.ids}).then(res => {\r\n          if (res.code === '200') {   // Indicates successful operation\r\n            this.$message.success('Operation successful')\r\n            this.load(1)\r\n          } else {\r\n            this.$message.error(res.msg)  // Show error message\r\n          }\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    load(pageNum) {  // Pagination query\r\n      if (pageNum) this.pageNum = pageNum\r\n      this.$request.get('/adopt/selectPage', {\r\n        params: {\r\n          pageNum: this.pageNum,\r\n          pageSize: this.pageSize,\r\n          status: this.status,  // 确保 status 变量被正确传递\r\n          animalId: this.animalId,\r\n        }\r\n      }).then(res => {\r\n        this.tableData = res.data?.list\r\n        this.total = res.data?.total\r\n        console.log(this.tableData)\r\n      })\r\n    },\r\n    reset() {\r\n      this.status = null  // Reset status variable\r\n      this.load(1)\r\n      this.animalId = null;\r\n      this.loadAnimal();\r\n    },\r\n    created() {\r\n      this.loadAnimal(); // 在组件创建时加载数据\r\n    },\r\n    handleCurrentChange(pageNum) {\r\n      this.load(pageNum)\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}