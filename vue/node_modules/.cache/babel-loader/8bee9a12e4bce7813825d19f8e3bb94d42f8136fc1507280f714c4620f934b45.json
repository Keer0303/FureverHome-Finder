{"ast":null,"code":"export default {\n  name: \"Adopt\",\n  data() {\n    return {\n      tableData: [],\n      // All data\n      pageNum: 1,\n      // Current page number\n      pageSize: 10,\n      // Number of items per page\n      total: 0,\n      animalId: null,\n      status: null,\n      // 初始化 status 变量\n      form: {},\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      ids: [],\n      animalData: []\n    };\n  },\n  created() {\n    this.load(1);\n    this.loadAnimal();\n  },\n  methods: {\n    loadAnimal() {\n      this.$request.get('/adopt/selectAnimal').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    handleAdd() {\n      // Add data\n      this.form = {}; // Clear data when adding new data\n      this.fromVisible = true; // Open the modal\n    },\n\n    handleEdit(row) {\n      // Edit data\n      this.form = JSON.parse(JSON.stringify(row)); // Deep copy data to form object\n      this.fromVisible = true; // Open the modal\n    },\n\n    save() {\n      // Logic triggered by save button, triggers add or update\n      this.$request({\n        url: this.form.id ? '/adopt/update' : '/adopt/add',\n        method: this.form.id ? 'PUT' : 'POST',\n        data: this.form\n      }).then(res => {\n        if (res.code === '200') {\n          // Indicates successful save\n          this.$message.success('Saved successfully');\n          this.load(1);\n          this.fromVisible = false;\n        } else {\n          this.$message.error(res.msg); // Show error message\n        }\n      });\n    },\n\n    GiveUp(row) {\n      this.$confirm('Are you sure you want to give up the adoption? Giving up the adoption means you will no longer be the potential adopter for this animal. If you have any concerns or need assistance, please contact our support team.', 'Confirm', {\n        type: \"warning\"\n      }).then(response => {\n        this.form = JSON.parse(JSON.stringify(row));\n        this.form.status = 'GiveUp Adoption';\n        this.save();\n      }).catch(() => {});\n    },\n    handleSelectionChange(rows) {\n      // Currently selected rows\n      this.ids = rows.map(v => v.id); //  [1,2]\n    },\n\n    delBatch() {\n      // Delete selected items\n      if (!this.ids.length) {\n        this.$message.warning('Please select data');\n        return;\n      }\n      this.$confirm('Are you sure you want to delete these data?', 'Confirm Delete', {\n        type: \"warning\"\n      }).then(response => {\n        this.$request.delete('/adopt/delete/batch', {\n          data: this.ids\n        }).then(res => {\n          if (res.code === '200') {\n            // Indicates successful operation\n            this.$message.success('Operation successful');\n            this.load(1);\n          } else {\n            this.$message.error(res.msg); // Show error message\n          }\n        });\n      }).catch(() => {});\n    },\n    load(pageNum) {\n      // Pagination query\n      if (pageNum) this.pageNum = pageNum;\n      this.$request.get('/adopt/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          status: this.status,\n          // 确保 status 变量被正确传递\n          animalId: this.animalId\n        }\n      }).then(res => {\n        this.tableData = res.data?.list;\n        this.total = res.data?.total;\n        console.log(this.tableData);\n      });\n    },\n    reset() {\n      this.status = null; // Reset status variable\n      this.load(1);\n    },\n    handleCurrentChange(pageNum) {\n      this.load(pageNum);\n    }\n  }\n};","map":{"version":3,"names":["name","data","tableData","pageNum","pageSize","total","animalId","status","form","user","JSON","parse","localStorage","getItem","ids","animalData","created","load","loadAnimal","methods","$request","get","then","res","code","$message","error","msg","handleAdd","fromVisible","handleEdit","row","stringify","save","url","id","method","success","GiveUp","$confirm","type","response","catch","handleSelectionChange","rows","map","v","delBatch","length","warning","delete","params","list","console","log","reset","handleCurrentChange"],"sources":["src/views/manager/Adopt.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"search\">\r\n      <el-select v-model=\"animalId\" placeholder=\"Search By Name\" style=\"width: 200px\">\r\n        <el-option v-for=\"item in animalData\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n      </el-select>\r\n      <el-select v-model=\"status\" placeholder=\"Search By Status\" style=\"width: 200px; margin-left: 5px\"v-if=\"user.role === 'ADMIN'\">\r\n        <el-option label=\"Adopted\" value=\"Adopted\"></el-option>\r\n        <el-option label=\"GiveUp Adoption\" value=\"GiveUp Adoption\"></el-option>\r\n      </el-select>\r\n      <el-button type=\"info\" plain style=\"margin-left: 10px\" @click=\"load(1)\">Search</el-button>\r\n      <el-button type=\"warning\" plain style=\"margin-left: 10px\" @click=\"reset\">Reset</el-button>\r\n    </div>\r\n\r\n    <div class=\"table\">\r\n      <el-table :data=\"tableData\" stripe @selection-change=\"handleSelectionChange\">\r\n        <el-table-column type=\"selection\" width=\"55\" align=\"center\"></el-table-column>\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\" align=\"center\" sortable></el-table-column>\r\n        <el-table-column prop=\"animalImg\" label=\"Pets Image\" show-overflow-tooltip>\r\n          <template v-slot=\"scope\">\r\n            <div style=\"display: flex; align-items: center\">\r\n              <el-image style=\"width: 40px; height: 40px; border-radius: 50%\" v-if=\"scope.row.animalImg\"\r\n                        :src=\"scope.row.animalImg\" :preview-src-list=\"[scope.row.animalImg]\"></el-image>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"animalName\" label=\"Pets Name\" show-overflow-tooltip></el-table-column>\r\n        <el-table-column prop=\"userName\" label=\"Adopter\" show-overflow-tooltip></el-table-column>\r\n        <el-table-column prop=\"time\" label=\"Adopt Time\"></el-table-column>\r\n        <el-table-column prop=\"status\" label=\"Adoption Status\"></el-table-column>\r\n        <el-table-column label=\"Actions\" width=\"180\" align=\"center\">\r\n          <template v-slot=\"scope\">\r\n            <el-button plain type=\"danger\" size=\"mini\" :disabled=\"scope.row.status === 'GiveUp Adoption'\" @click=\"GiveUp(scope.row)\">Give Up Adoption</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n            background\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"pageNum\"\r\n            :page-sizes=\"[5, 10, 20]\"\r\n            :page-size=\"pageSize\"\r\n            layout=\"total, prev, pager, next\"\r\n            :total=\"total\">\r\n        </el-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Adopt\",\r\n  data() {\r\n    return {\r\n      tableData: [],  // All data\r\n      pageNum: 1,   // Current page number\r\n      pageSize: 10,  // Number of items per page\r\n      total: 0,\r\n      animalId: null,\r\n      status: null,  // 初始化 status 变量\r\n      form: {},\r\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\r\n      ids: [],\r\n      animalData:[]\r\n    }\r\n  },\r\n  created() {\r\n    this.load(1)\r\n    this.loadAnimal();\r\n  },\r\n  methods: {\r\n    loadAnimal() {\r\n      this.$request.get('/adopt/selectAnimal').then(res => {\r\n        if (res.code === '200') {\r\n          this.animalData = res.data\r\n        } else {\r\n          this.$message.error(res.msg)\r\n        }\r\n      })\r\n    },\r\n    handleAdd() {   // Add data\r\n      this.form = {}  // Clear data when adding new data\r\n      this.fromVisible = true   // Open the modal\r\n    },\r\n    handleEdit(row) {   // Edit data\r\n      this.form = JSON.parse(JSON.stringify(row))  // Deep copy data to form object\r\n      this.fromVisible = true   // Open the modal\r\n    },\r\n    save() {   // Logic triggered by save button, triggers add or update\r\n      this.$request({\r\n        url: this.form.id ? '/adopt/update' : '/adopt/add',\r\n        method: this.form.id ? 'PUT' : 'POST',\r\n        data: this.form\r\n      }).then(res => {\r\n        if (res.code === '200') {  // Indicates successful save\r\n          this.$message.success('Saved successfully')\r\n          this.load(1)\r\n          this.fromVisible = false\r\n        } else {\r\n          this.$message.error(res.msg)  // Show error message\r\n        }\r\n      })\r\n    },\r\n    GiveUp(row) {\r\n      this.$confirm('Are you sure you want to give up the adoption? Giving up the adoption means you will no longer be the potential adopter for this animal. If you have any concerns or need assistance, please contact our support team.', 'Confirm', {type: \"warning\"}).then(response => {\r\n        this.form = JSON.parse(JSON.stringify(row));\r\n        this.form.status = 'GiveUp Adoption';\r\n        this.save();\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    handleSelectionChange(rows) {   // Currently selected rows\r\n      this.ids = rows.map(v => v.id)   //  [1,2]\r\n    },\r\n    delBatch() {   // Delete selected items\r\n      if (!this.ids.length) {\r\n        this.$message.warning('Please select data')\r\n        return\r\n      }\r\n      this.$confirm('Are you sure you want to delete these data?', 'Confirm Delete', {type: \"warning\"}).then(response => {\r\n        this.$request.delete('/adopt/delete/batch', {data: this.ids}).then(res => {\r\n          if (res.code === '200') {   // Indicates successful operation\r\n            this.$message.success('Operation successful')\r\n            this.load(1)\r\n          } else {\r\n            this.$message.error(res.msg)  // Show error message\r\n          }\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    load(pageNum) {  // Pagination query\r\n      if (pageNum) this.pageNum = pageNum\r\n      this.$request.get('/adopt/selectPage', {\r\n        params: {\r\n          pageNum: this.pageNum,\r\n          pageSize: this.pageSize,\r\n          status: this.status,  // 确保 status 变量被正确传递\r\n          animalId: this.animalId,\r\n        }\r\n      }).then(res => {\r\n        this.tableData = res.data?.list\r\n        this.total = res.data?.total\r\n        console.log(this.tableData)\r\n      })\r\n    },\r\n    reset() {\r\n      this.status = null  // Reset status variable\r\n      this.load(1)\r\n    },\r\n    handleCurrentChange(pageNum) {\r\n      this.load(pageNum)\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}