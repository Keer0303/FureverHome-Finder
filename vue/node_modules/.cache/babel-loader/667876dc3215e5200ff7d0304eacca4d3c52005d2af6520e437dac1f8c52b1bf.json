{"ast":null,"code":"export default {\n  name: 'Home',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      notices: [],\n      animalData: [],\n      dialogVisible: false,\n      adoptionFormVisible: false,\n      noticeDialogVisible: false,\n      selectedAnimal: {},\n      adoptionForm: {\n        reason: ''\n      },\n      formLabelWidth: '120px'\n    };\n  },\n  created() {\n    this.loadNotices();\n    this.loadAnimal();\n  },\n  methods: {\n    loadNotices() {\n      this.$request.get('/notice/selectAll').then(res => {\n        if (res.code === '200') {\n          this.notices = res.data || [];\n        } else {\n          this.$message.error('Failed to load notices');\n        }\n      }).catch(error => {\n        console.error('Error loading notices:', error);\n        this.$message.error('An error occurred while loading notices');\n      });\n    },\n    loadAnimal() {\n      this.$request.get('/animal/selectAll').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      }).catch(error => {\n        console.error('Error loading animal data:', error);\n        this.$message.error('An error occurred while loading animal data');\n      });\n    },\n    openAdoptionForm(animal) {\n      this.selectedAnimal = animal;\n      this.adoptionFormVisible = true;\n    },\n    submitAdoptionForm() {\n      if (!this.adoptionForm.reason) {\n        this.$message.error('Please fill in the reason for adoption');\n        return;\n      }\n      let applicationData = {\n        userId: this.user.id,\n        animalId: this.selectedAnimal.id,\n        name: this.user.name,\n        email: this.user.email,\n        phone: this.user.phone,\n        reason: this.adoptionForm.reason,\n        status: 'Pending'\n      };\n      this.$request.post('/application/add', applicationData).then(res => {\n        if (res.code === '200') {\n          this.$message.success('Adoption request sent');\n          this.adoptionFormVisible = false;\n          this.resetAdoptionForm();\n          this.loadAnimal(); // Reload animal data to reflect the status change\n        } else {\n          this.$message.error('Failed to send adoption request');\n        }\n      }).catch(error => {\n        console.error('Error sending adoption request:', error.response || error.message || error);\n        this.$message.error('An error occurred while sending adoption request');\n      });\n    },\n    resetAdoptionForm() {\n      this.adoptionForm = {\n        reason: ''\n      };\n    },\n    showDetails(animal) {\n      this.selectedAnimal = animal;\n      this.dialogVisible = true;\n    },\n    handleClose(done) {\n      this.dialogVisible = false;\n      done();\n    },\n    showNotices() {\n      this.noticeDialogVisible = true;\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","localStorage","getItem","notices","animalData","dialogVisible","adoptionFormVisible","noticeDialogVisible","selectedAnimal","adoptionForm","reason","formLabelWidth","created","loadNotices","loadAnimal","methods","$request","get","then","res","code","$message","error","catch","console","msg","openAdoptionForm","animal","submitAdoptionForm","applicationData","userId","id","animalId","email","phone","status","post","success","resetAdoptionForm","response","message","showDetails","handleClose","done","showNotices"],"sources":["src/views/manager/Home.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"card header-card\">\n      Hello, {{ user?.name }},  Welcome to Furever Home Finder!\n      <el-button type=\"primary\" @click=\"showNotices\" class=\"notice-button\">Notice</el-button>\n    </div>\n\n    <div class=\"content\">\n      <div class=\"card pet-info-card\">\n        <!-- Pet Info -->\n        <div class=\"pet-info-title\">Adopt love, one paw at a time.</div>\n        <el-row>\n          <el-col :span=\"6\" v-for=\"item in animalData\" :key=\"item.id\">\n            <div class=\"card pet-card\">\n              <img :src=\"item.img\" alt=\"\" class=\"pet-image\">\n              <div class=\"pet-name\">{{ item.name }} <br>（{{ item.species }}）</div>\n              <div class=\"pet-details\">Sex：{{ item.sex }}， Age：{{ item.age }}</div>\n              <div class=\"pet-status\">Status：<span class=\"status-text\">{{ item.status }}</span></div>\n              <div class=\"about-me\">About me：<br><span class=\"about-me-text\">{{ item.descr }}</span></div>\n              <div>\n                <el-button type=\"success\" size=\"mini\" class=\"adopt-button\" :disabled=\"item.status === 'Adopted' || item.status === 'In Process' || user.role === 'ADMIN'\" @click=\"openAdoptionForm(item)\">Apply to Adopt</el-button>\n                <el-button type=\"primary\" size=\"mini\" class=\"details-button\" @click=\"showDetails(item)\">View Details</el-button>\n              </div>\n            </div>\n          </el-col>\n        </el-row>\n      </div>\n    </div>\n\n    <!-- 申请领养表单对话框 -->\n    <el-dialog :visible.sync=\"adoptionFormVisible\" width=\"40%\" title=\"Adoption Application\">\n      <el-form :model=\"adoptionForm\" ref=\"adoptionForm\">\n        <el-form-item label=\"Reason\" :label-width=\"formLabelWidth\">\n          <el-input type=\"textarea\" :rows=\"4\" v-model=\"adoptionForm.reason\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"adoptionFormVisible = false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"submitAdoptionForm\">Submit</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 详情对话框 -->\n    <el-dialog :visible.sync=\"dialogVisible\" width=\"30%\" :before-close=\"handleClose\">\n      <span slot=\"title\">{{ selectedAnimal.name }}'s Details</span>\n      <div>\n        <img :src=\"selectedAnimal.img\" alt=\"\" class=\"details-image\">\n        <div class=\"details-name\">{{ selectedAnimal.name }}</div>\n        <div class=\"details-info\">Species: {{ selectedAnimal.species }}</div>\n        <div class=\"details-info\">Sex: {{ selectedAnimal.sex }}</div>\n        <div class=\"details-info\">Age: {{ selectedAnimal.age }}</div>\n        <div class=\"details-info\">Status: <span :style=\"{ color: selectedAnimal.status === 'Adopted' ? '#7d3d0c' : '#000' }\">{{ selectedAnimal.status }}</span></div>\n        <div class=\"details-about\">About me: {{ selectedAnimal.descr }}</div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">Close</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 公告对话框 -->\n    <el-dialog :visible.sync=\"noticeDialogVisible\" width=\"50%\" title=\"Notice\">\n      <el-timeline reverse>\n        <el-timeline-item v-for=\"item in notices\" :key=\"item.id\" :timestamp=\"item.time\">\n          <el-popover\n              placement=\"right\"\n              width=\"200\"\n              trigger=\"hover\"\n              :content=\"item.content\">\n            <span slot=\"reference\">{{ item.title }}</span>\n          </el-popover>\n        </el-timeline-item>\n      </el-timeline>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"noticeDialogVisible = false\">Close</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Home',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      notices: [],\n      animalData: [],\n      dialogVisible: false,\n      adoptionFormVisible: false,\n      noticeDialogVisible: false,\n      selectedAnimal: {},\n      adoptionForm: {\n        reason: ''\n      },\n      formLabelWidth: '120px'\n    }\n  },\n  created() {\n    this.loadNotices();\n    this.loadAnimal();\n  },\n  methods: {\n    loadNotices() {\n      this.$request.get('/notice/selectAll').then(res => {\n        if (res.code === '200') {\n          this.notices = res.data || []\n        } else {\n          this.$message.error('Failed to load notices');\n        }\n      }).catch(error => {\n        console.error('Error loading notices:', error);\n        this.$message.error('An error occurred while loading notices');\n      });\n    },\n    loadAnimal() {\n      this.$request.get('/animal/selectAll').then(res => {\n        if (res.code === '200') {\n          this.animalData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      }).catch(error => {\n        console.error('Error loading animal data:', error);\n        this.$message.error('An error occurred while loading animal data');\n      });\n    },\n    openAdoptionForm(animal) {\n      this.selectedAnimal = animal;\n      this.adoptionFormVisible = true;\n    },\n    submitAdoptionForm() {\n      if (!this.adoptionForm.reason) {\n        this.$message.error('Please fill in the reason for adoption');\n        return;\n      }\n\n      let applicationData = {\n        userId: this.user.id,\n        animalId: this.selectedAnimal.id,\n        name: this.user.name,\n        email: this.user.email,\n        phone: this.user.phone,\n        reason: this.adoptionForm.reason,\n        status: 'Pending'\n      };\n\n      this.$request.post('/application/add', applicationData).then(res => {\n        if (res.code === '200') {\n          this.$message.success('Adoption request sent');\n          this.adoptionFormVisible = false;\n          this.resetAdoptionForm();\n          this.loadAnimal(); // Reload animal data to reflect the status change\n        } else {\n          this.$message.error('Failed to send adoption request');\n        }\n      }).catch(error => {\n        console.error('Error sending adoption request:', error.response || error.message || error);\n        this.$message.error('An error occurred while sending adoption request');\n      });\n    },\n    resetAdoptionForm() {\n      this.adoptionForm = {\n        reason: ''\n      };\n    },\n    showDetails(animal) {\n      this.selectedAnimal = animal;\n      this.dialogVisible = true;\n    },\n    handleClose(done) {\n      this.dialogVisible = false;\n      done();\n    },\n    showNotices() {\n      this.noticeDialogVisible = true;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.el-col-6 {\n  padding: 10px;\n}\n\n.container {\n  display: flex;\n  flex-direction: row;\n}\n\n.header-card {\n  padding: 15px;\n  font-size: 24px;\n  font-weight: bold;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.notice-button {\n  margin-left: auto;\n}\n\n.content {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n}\n\n.pet-info-card {\n  width: 100%;\n  padding: 15px;\n}\n\n.pet-info-title {\n  margin-bottom: 20px;\n  font-size: 20px;\n  font-weight: bold;\n  color: #1F618D;\n}\n\n.pet-card {\n  background-color: #f8f4e8;\n  text-align: center;\n}\n\n.pet-image {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.pet-name {\n  font-weight: bold;\n  color: #817a70;\n  margin-top: 5px;\n}\n\n.pet-details, .pet-status {\n  color: #575353;\n  font-size: 13px;\n  margin-top: 5px;\n}\n\n.pet-status {\n  color: #7d3d0c;\n}\n\n.status-text {\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n}\n\n.about-me {\n  margin-top: 15px;\n  color: #4b4949;\n  text-align: left;\n}\n\n.about-me-text {\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n}\n\n.adopt-button, .details-button {\n  margin-top: 20px;\n}\n\n.details-image {\n  width: 300px;\n  height: 300px;\n  display: block;\n  margin: 0 auto;\n  object-fit: contain;\n}\n\n.details-name {\n  text-align: center;\n  margin-top: 10px;\n  font-weight: bold;\n  font-size: 18px;\n}\n\n.details-info, .details-about {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"AAgFA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,OAAA;MACAC,UAAA;MACAC,aAAA;MACAC,mBAAA;MACAC,mBAAA;MACAC,cAAA;MACAC,YAAA;QACAC,MAAA;MACA;MACAC,cAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;IACA,KAAAC,UAAA;EACA;EACAC,OAAA;IACAF,YAAA;MACA,KAAAG,QAAA,CAAAC,GAAA,sBAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAjB,OAAA,GAAAgB,GAAA,CAAAtB,IAAA;QACA;UACA,KAAAwB,QAAA,CAAAC,KAAA;QACA;MACA,GAAAC,KAAA,CAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,2BAAAA,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IACAR,WAAA;MACA,KAAAE,QAAA,CAAAC,GAAA,sBAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAhB,UAAA,GAAAe,GAAA,CAAAtB,IAAA;QACA;UACA,KAAAwB,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAM,GAAA;QACA;MACA,GAAAF,KAAA,CAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,+BAAAA,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IACAI,iBAAAC,MAAA;MACA,KAAAnB,cAAA,GAAAmB,MAAA;MACA,KAAArB,mBAAA;IACA;IACAsB,mBAAA;MACA,UAAAnB,YAAA,CAAAC,MAAA;QACA,KAAAW,QAAA,CAAAC,KAAA;QACA;MACA;MAEA,IAAAO,eAAA;QACAC,MAAA,OAAAhC,IAAA,CAAAiC,EAAA;QACAC,QAAA,OAAAxB,cAAA,CAAAuB,EAAA;QACAnC,IAAA,OAAAE,IAAA,CAAAF,IAAA;QACAqC,KAAA,OAAAnC,IAAA,CAAAmC,KAAA;QACAC,KAAA,OAAApC,IAAA,CAAAoC,KAAA;QACAxB,MAAA,OAAAD,YAAA,CAAAC,MAAA;QACAyB,MAAA;MACA;MAEA,KAAAnB,QAAA,CAAAoB,IAAA,qBAAAP,eAAA,EAAAX,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAgB,OAAA;UACA,KAAA/B,mBAAA;UACA,KAAAgC,iBAAA;UACA,KAAAxB,UAAA;QACA;UACA,KAAAO,QAAA,CAAAC,KAAA;QACA;MACA,GAAAC,KAAA,CAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,oCAAAA,KAAA,CAAAiB,QAAA,IAAAjB,KAAA,CAAAkB,OAAA,IAAAlB,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IACAgB,kBAAA;MACA,KAAA7B,YAAA;QACAC,MAAA;MACA;IACA;IACA+B,YAAAd,MAAA;MACA,KAAAnB,cAAA,GAAAmB,MAAA;MACA,KAAAtB,aAAA;IACA;IACAqC,YAAAC,IAAA;MACA,KAAAtC,aAAA;MACAsC,IAAA;IACA;IACAC,YAAA;MACA,KAAArC,mBAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}